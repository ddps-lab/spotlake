FROM amazonlinux:2

# Update base packages & install utilities
RUN yum update -y \
    && yum install -y \
    aws-cli \
    python3 \
    python3-venv \
    unzip \
    && yum clean all

# Set the working directory
WORKDIR /app

# Create a Python virtual env & install required Python packages
ENV PYTHON_VENV_PATH=/app/venv
RUN python3 -m venv $PYTHON_VENV_PATH \
    && source $PYTHON_VENV_PATH/bin/activate \
    && pip install --upgrade pip --no-cache-dir  \
    && pip install "boto3[crt]" --no-cache-dir  \
    && pip install requests --no-cache-dir 

# Copy code & set permissions
COPY montly_share_raw_dataset_generator.py /app/batch.py
COPY script.sh /app/batch.py
RUN chmod +x /app/batch.py

# Set the default command
CMD ["python", "/app/batch.py"]
